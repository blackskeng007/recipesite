<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Finder</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Simple icon components
        const Search = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
        );

        const Heart = ({ size = 24, className = "", fill = "none" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
        );

        const ChefHat = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M6 13.87A4 4 0 0 1 7.41 6 5 5 0 0 1 11 4.44a5 5 0 0 1 2 0 5 5 0 0 1 3.59 1.56 4 4 0 0 1 1.41 7.87"></path>
                <path d="M3.71 14.5a2 2 0 0 0 2.83 2.83"></path>
                <path d="M17.46 17.33a2 2 0 0 0 2.83 2.83"></path>
                <path d="M15.39 15.39l2.83-2.83"></path>
                <path d="M5.71 5.71l2.83-2.83"></path>
                <path d="M2 2l20 20"></path>
            </svg>
        );

        const X = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        const Loader = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" y1="2" x2="12" y2="6"></line>
                <line x1="12" y1="18" x2="12" y2="22"></line>
                <line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line>
                <line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line>
                <line x1="2" y1="12" x2="6" y2="12"></line>
                <line x1="18" y1="12" x2="22" y2="12"></line>
                <line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line>
                <line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line>
            </svg>
        );

        // Storage helper using localStorage
        const storage = {
            async set(key, value) {
                localStorage.setItem(key, value);
            },
            async get(key) {
                const value = localStorage.getItem(key);
                return value ? { value } : null;
            },
            async delete(key) {
                localStorage.removeItem(key);
            },
            async list(prefix) {
                const keys = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith(prefix)) {
                        keys.push(key);
                    }
                }
                return { keys };
            }
        };

        function RecipeFinder() {
            const [searchQuery, setSearchQuery] = useState('');
            const [recipes, setRecipes] = useState([]);
            const [selectedRecipe, setSelectedRecipe] = useState(null);
            const [favorites, setFavorites] = useState([]);
            const [loading, setLoading] = useState(false);
            const [view, setView] = useState('search');

            useEffect(() => {
                loadFavorites();
            }, []);

            const loadFavorites = async () => {
                try {
                    const result = await storage.list('fav:');
                    if (result && result.keys) {
                        const favRecipes = await Promise.all(
                            result.keys.map(async (key) => {
                                const data = await storage.get(key);
                                return data ? JSON.parse(data.value) : null;
                            })
                        );
                        setFavorites(favRecipes.filter(r => r !== null));
                    }
                } catch (error) {
                    console.log('No favorites yet');
                }
            };

            const searchRecipes = async () => {
                if (!searchQuery.trim()) return;
                
                setLoading(true);
                try {
                    const response = await fetch(
                        `https://www.themealdb.com/api/json/v1/1/search.php?s=${encodeURIComponent(searchQuery)}`
                    );
                    const data = await response.json();
                    setRecipes(data.meals || []);
                    setView('search');
                } catch (error) {
                    console.error('Error fetching recipes:', error);
                    setRecipes([]);
                }
                setLoading(false);
            };

            const getRandomRecipes = async () => {
                setLoading(true);
                try {
                    const randomRecipes = [];
                    for (let i = 0; i < 8; i++) {
                        const response = await fetch('https://www.themealdb.com/api/json/v1/1/random.php');
                        const data = await response.json();
                        if (data.meals) randomRecipes.push(data.meals[0]);
                    }
                    setRecipes(randomRecipes);
                    setView('search');
                } catch (error) {
                    console.error('Error fetching random recipes:', error);
                }
                setLoading(false);
            };

            const toggleFavorite = async (recipe) => {
                const isFavorite = favorites.some(fav => fav.idMeal === recipe.idMeal);
                
                try {
                    if (isFavorite) {
                        await storage.delete(`fav:${recipe.idMeal}`);
                        setFavorites(favorites.filter(fav => fav.idMeal !== recipe.idMeal));
                    } else {
                        await storage.set(`fav:${recipe.idMeal}`, JSON.stringify(recipe));
                        setFavorites([...favorites, recipe]);
                    }
                } catch (error) {
                    console.error('Error updating favorites:', error);
                }
            };

            const isFavorite = (recipeId) => {
                return favorites.some(fav => fav.idMeal === recipeId);
            };

            const getIngredients = (recipe) => {
                const ingredients = [];
                for (let i = 1; i <= 20; i++) {
                    const ingredient = recipe[`strIngredient${i}`];
                    const measure = recipe[`strMeasure${i}`];
                    if (ingredient && ingredient.trim()) {
                        ingredients.push(`${measure || ''} ${ingredient}`.trim());
                    }
                }
                return ingredients;
            };

            const RecipeCard = ({ recipe }) => (
                <div className="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                    <div className="relative">
                        <img 
                            src={recipe.strMealThumb} 
                            alt={recipe.strMeal}
                            className="w-full h-48 object-cover"
                        />
                        <button
                            onClick={(e) => {
                                e.stopPropagation();
                                toggleFavorite(recipe);
                            }}
                            className={`absolute top-3 right-3 p-2 rounded-full transition-all ${
                                isFavorite(recipe.idMeal)
                                    ? 'bg-red-500 text-white'
                                    : 'bg-white text-gray-600 hover:bg-red-50'
                            }`}
                        >
                            <Heart size={20} fill={isFavorite(recipe.idMeal) ? 'currentColor' : 'none'} />
                        </button>
                        <div className="absolute bottom-3 left-3 bg-orange-500 text-white px-3 py-1 rounded-full text-sm font-medium">
                            {recipe.strCategory}
                        </div>
                    </div>
                    <div className="p-4">
                        <h3 className="font-bold text-lg mb-2 text-gray-800 line-clamp-1">{recipe.strMeal}</h3>
                        <div className="flex items-center text-gray-600 text-sm mb-3">
                            <span className="flex items-center gap-1">
                                <ChefHat size={16} />
                                {recipe.strArea}
                            </span>
                        </div>
                        <button
                            onClick={() => setSelectedRecipe(recipe)}
                            className="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-2 rounded-lg hover:from-orange-600 hover:to-red-600 transition-all font-medium"
                        >
                            View Recipe
                        </button>
                    </div>
                </div>
            );

            const RecipeDetail = ({ recipe, onClose }) => (
                <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto">
                    <div className="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div className="sticky top-0 bg-white z-10 border-b p-4 flex justify-between items-center">
                            <h2 className="text-2xl font-bold text-gray-800">{recipe.strMeal}</h2>
                            <button
                                onClick={onClose}
                                className="p-2 hover:bg-gray-100 rounded-full transition"
                            >
                                <X size={24} />
                            </button>
                        </div>
                        
                        <div className="p-6">
                            <img 
                                src={recipe.strMealThumb} 
                                alt={recipe.strMeal}
                                className="w-full h-64 object-cover rounded-xl mb-6"
                            />
                            
                            <div className="flex gap-4 mb-6 flex-wrap">
                                <span className="flex items-center gap-2 bg-orange-100 text-orange-700 px-4 py-2 rounded-full">
                                    <ChefHat size={18} />
                                    {recipe.strArea}
                                </span>
                                <span className="flex items-center gap-2 bg-purple-100 text-purple-700 px-4 py-2 rounded-full">
                                    {recipe.strCategory}
                                </span>
                                <button
                                    onClick={() => toggleFavorite(recipe)}
                                    className={`flex items-center gap-2 px-4 py-2 rounded-full transition ${
                                        isFavorite(recipe.idMeal)
                                            ? 'bg-red-500 text-white'
                                            : 'bg-gray-100 text-gray-700 hover:bg-red-50'
                                    }`}
                                >
                                    <Heart size={18} fill={isFavorite(recipe.idMeal) ? 'currentColor' : 'none'} />
                                    {isFavorite(recipe.idMeal) ? 'Saved' : 'Save'}
                                </button>
                            </div>

                            <div className="mb-6">
                                <h3 className="text-xl font-bold mb-3 text-gray-800">Ingredients</h3>
                                <ul className="grid grid-cols-1 md:grid-cols-2 gap-2">
                                    {getIngredients(recipe).map((ingredient, index) => (
                                        <li key={index} className="flex items-center gap-2 text-gray-700">
                                            <span className="w-2 h-2 bg-orange-500 rounded-full"></span>
                                            {ingredient}
                                        </li>
                                    ))}
                                </ul>
                            </div>

                            <div>
                                <h3 className="text-xl font-bold mb-3 text-gray-800">Instructions</h3>
                                <p className="text-gray-700 whitespace-pre-line leading-relaxed">
                                    {recipe.strInstructions}
                                </p>
                            </div>

                            {recipe.strYoutube && (
                                <div className="mt-6">
                                    <h3 className="text-xl font-bold mb-3 text-gray-800">Video Tutorial</h3>
                                    <a
                                        href={recipe.strYoutube}
                                        target="_blank"
                                        rel="noopener noreferrer"
                                        className="inline-flex items-center gap-2 bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition"
                                    >
                                        Watch on YouTube
                                    </a>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen bg-gradient-to-br from-orange-50 to-red-50">
                    <div className="max-w-7xl mx-auto p-4 md:p-8">
                        <div className="text-center mb-8">
                            <h1 className="text-5xl font-bold text-gray-800 mb-2 flex items-center justify-center gap-3">
                                <ChefHat className="text-orange-500" size={48} />
                                Recipe Finder
                            </h1>
                            <p className="text-gray-600 text-lg">Discover delicious recipes from around the world</p>
                        </div>

                        <div className="bg-white rounded-2xl shadow-xl p-6 mb-8">
                            <div className="flex gap-3 mb-4">
                                <div className="flex-1 relative">
                                    <input
                                        type="text"
                                        placeholder="Search for recipes (e.g., chicken, pasta, cake)..."
                                        value={searchQuery}
                                        onChange={(e) => setSearchQuery(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && searchRecipes()}
                                        className="w-full pl-12 pr-4 py-4 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:outline-none text-lg"
                                    />
                                    <Search className="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400" size={24} />
                                </div>
                                <button
                                    onClick={searchRecipes}
                                    disabled={loading}
                                    className="bg-gradient-to-r from-orange-500 to-red-500 text-white px-8 py-4 rounded-xl hover:from-orange-600 hover:to-red-600 transition-all font-medium disabled:opacity-50"
                                >
                                    {loading ? <Loader className="animate-spin" size={24} /> : 'Search'}
                                </button>
                            </div>
                            
                            <div className="flex gap-3 justify-center">
                                <button
                                    onClick={getRandomRecipes}
                                    disabled={loading}
                                    className="bg-purple-500 text-white px-6 py-2 rounded-lg hover:bg-purple-600 transition disabled:opacity-50"
                                >
                                    üé≤ Surprise Me
                                </button>
                                <button
                                    onClick={() => setView('favorites')}
                                    className="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition flex items-center gap-2"
                                >
                                    <Heart size={18} />
                                    Favorites ({favorites.length})
                                </button>
                            </div>
                        </div>

                        {loading && (
                            <div className="flex justify-center items-center py-20">
                                <Loader className="animate-spin text-orange-500" size={48} />
                            </div>
                        )}

                        {!loading && recipes.length === 0 && view === 'search' && (
                            <div className="text-center py-20">
                                <ChefHat className="mx-auto text-gray-300 mb-4" size={64} />
                                <h3 className="text-2xl font-bold text-gray-800 mb-2">No recipes yet</h3>
                                <p className="text-gray-600">Search for your favorite dish or try the surprise button!</p>
                            </div>
                        )}

                        {view === 'search' && recipes.length > 0 && (
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                {recipes.map((recipe) => (
                                    <RecipeCard key={recipe.idMeal} recipe={recipe} />
                                ))}
                            </div>
                        )}

                        {view === 'favorites' && (
                            <div>
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-3xl font-bold text-gray-800">Your Favorites</h2>
                                    <button
                                        onClick={() => setView('search')}
                                        className="text-orange-500 hover:text-orange-600 font-medium"
                                    >
                                        ‚Üê Back to Search
                                    </button>
                                </div>
                                {favorites.length === 0 ? (
                                    <div className="text-center py-20 bg-white rounded-2xl">
                                        <Heart className="mx-auto text-gray-300 mb-4" size={64} />
                                        <h3 className="text-2xl font-bold text-gray-800 mb-2">No favorites yet</h3>
                                        <p className="text-gray-600">Start adding recipes to your favorites!</p>
                                    </div>
                                ) : (
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                        {favorites.map((recipe) => (
                                            <RecipeCard key={recipe.idMeal} recipe={recipe} />
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}

                        {selectedRecipe && (
                            <RecipeDetail 
                                recipe={selectedRecipe} 
                                onClose={() => setSelectedRecipe(null)} 
                            />
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<RecipeFinder />);
    </script>
</body>
</html>
